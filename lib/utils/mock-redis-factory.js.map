{"version":3,"sources":["../../src/utils/mock-redis-factory.js"],"names":["mockRedisFactory","overrideMethods","events","instance","cbs","namespaces","Object","assign","subscribe","ns","push","publish","data","forEach","cb","on","event","scanStream","match","cound"],"mappings":";;;;;AAAO,MAAMA,8CAAmB,CAACC,kBAAkB,EAAnB,EAAuB,EAACC,SAAS,EAAV,KAAgB,EAAvC,KAA8C;AAC5E,MAAIC,QAAJ;AACA,SAAO,MAAM;AACX,UAAMC,MAAM,EAAZ;AACA,UAAMC,aAAa,EAAnB;AACA,QAAIF,QAAJ,EAAc;AACZ,aAAOA,QAAP;AACD;AACDA,eAAWG,OAAOC,MAAP,CAAc;AACvBC,iBAAYC,EAAD,IAAQ;AACjBJ,mBAAWK,IAAX,CAAgBD,EAAhB;AACD,OAHsB;AAIvBE,eAAS,CAACF,EAAD,EAAKG,IAAL,KAAc;AACrB,SAACR,IAAIK,EAAJ,KAAW,EAAZ,EAAgBI,OAAhB,CAAyBC,EAAD,IAAQA,GAAGL,EAAH,EAAOG,IAAP,CAAhC;AACD,OANsB;AAOvBG,UAAI,CAACC,KAAD,EAAQF,EAAR,KAAe;AACjBT,mBAAWQ,OAAX,CAAoBJ,EAAD,IAAQ;AACzB,cAAI,CAACL,IAAIK,EAAJ,CAAL,EAAc;AACZL,gBAAIK,EAAJ,IAAU,EAAV;AACD;AACDL,cAAIK,EAAJ,EAAQC,IAAR,CAAaI,EAAb;AACD,SALD;AAMD,OAdsB;AAevBG,kBAAY,CAAC,EAACC,KAAD,EAAQC,KAAR,EAAD,KAAoB;AAC9B,eAAO;AACLJ,cAAI,CAACC,KAAD,EAAQF,EAAR,KAAe;AACjB,gBAAI,CAACZ,OAAOc,KAAP,CAAL,EAAoB;AAClBd,qBAAOc,KAAP,IAAgB,EAAhB;AACD;AACDd,mBAAOc,KAAP,EAAcN,IAAd,CAAmBI,EAAnB;AACD;AANI,SAAP;AAQD;;AAxBsB,KAAd,EA0BRb,eA1BQ,CAAX;AA2BA,WAAOE,QAAP;AACD,GAlCD;AAmCD,CArCM","file":"mock-redis-factory.js","sourcesContent":["export const mockRedisFactory = (overrideMethods = {}, {events = {}} = {}) => {\n  let instance\n  return () => {\n    const cbs = {}\n    const namespaces = []\n    if (instance) {\n      return instance\n    }\n    instance = Object.assign({\n      subscribe: (ns) => {\n        namespaces.push(ns)\n      },\n      publish: (ns, data) => {\n        (cbs[ns] || []).forEach((cb) => cb(ns, data))\n      },\n      on: (event, cb) => {\n        namespaces.forEach((ns) => {\n          if (!cbs[ns]) {\n            cbs[ns] = []\n          }\n          cbs[ns].push(cb)\n        })\n      },\n      scanStream: ({match, cound}) => {\n        return {\n          on: (event, cb) => {\n            if (!events[event]) {\n              events[event] = []\n            }\n            events[event].push(cb)\n          }\n        }\n      }\n\n    }, overrideMethods)\n    return instance\n  }\n}\n"]}